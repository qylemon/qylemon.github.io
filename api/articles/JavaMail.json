{"title":"SpringBoot使用JavaMail发送SMTP遇到的坑","slug":"JavaMail","date":"2019-03-21T14:24:59.343Z","updated":"2019-03-13T09:19:23.770Z","comments":true,"path":"api/articles/JavaMail.json","excerpt":"添加maven依赖&lt;dependency&gt;    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;&lt;/dependency&gt;","covers":null,"content":"<h2 id=\"添加maven依赖\"><a href=\"#添加maven依赖\" class=\"headerlink\" title=\"添加maven依赖\"></a>添加maven依赖</h2><pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre><a id=\"more\"></a>\n<h2 id=\"添加properties配置\"><a href=\"#添加properties配置\" class=\"headerlink\" title=\"添加properties配置\"></a>添加properties配置</h2><pre><code>#email 配置\nspring.mail.host=smtp.xxx.com\nspring.mail.username=xxxxxxx@163.com\n//此处password是校验码不是邮箱密码可自行百度\nspring.mail.password=xxxxxxxx\nspring.mail.properties.mail.smtp.starttls.enable=true\nspring.mail.properties.mail.smtp.port=25 //端口号\nspring.mail.default-encoding=UTF-8\n</code></pre><h2 id=\"添加测试方法\"><a href=\"#添加测试方法\" class=\"headerlink\" title=\"添加测试方法\"></a>添加测试方法</h2><pre><code>@Autowired\nJavaMailSender mailSender;   //自动注入邮件配置\n\n@Value(&quot;${spring.mail.username}&quot;)\nprivate String Sender; //读取配置文件中的参数\n\npublic String sendSimpleMail(){\n    SimpleMailMessage message = new SimpleMailMessage();\n    message.setFrom(Sender);   //邮件发送人\n    //需要多人接收使用list 集合 不需要可以直接使用message的几个方法\n    List&lt;String&gt; list = new ArrayList&lt;String&gt;();\n    list.add(&quot;xxxx@xxx.com&quot;);\n    list.add(&quot;xxx@xxx.com&quot;);\n    for (int i = 0; i &lt; list.size(); i++) {\n        String obj=(String)list.get(i);\n        message.setTo(obj);\n        message.setSubject(&quot;订单&quot;);   //邮件主题\n        message.setText(pd.getString(&quot;message&quot;)+pd.get(&quot;uid&quot;));   //邮件内容\n        mailSender.send(message);\n    }\n    return &quot;OK&quot;;\n}\n</code></pre><h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><pre><code>邮箱开放25/465端口(基本,有些开放其他端口)发送邮件\nmessage.setTo //接收人\nmessage.setCc //抄送人\n...\n阿里ecs默认封25端口 可以使用ssl 传输\n</code></pre><h2 id=\"ssl加密发送邮件\"><a href=\"#ssl加密发送邮件\" class=\"headerlink\" title=\"ssl加密发送邮件\"></a>ssl加密发送邮件</h2><pre><code>修改properties配置\n//spring.mail.properties.mail.smtp.port=25\nspring.mail.properties.mail.smtp.port=465\n添加properties配置:\n#SSL证书Socket工厂\nspring.mail.properties.mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory\n</code></pre><p>使用465 服务器成功发送(<em>^_^</em>)</p>\n","more":"<h2 id=\"添加properties配置\"><a href=\"#添加properties配置\" class=\"headerlink\" title=\"添加properties配置\"></a>添加properties配置</h2><pre><code>#email 配置\nspring.mail.host=smtp.xxx.com\nspring.mail.username=xxxxxxx@163.com\n//此处password是校验码不是邮箱密码可自行百度\nspring.mail.password=xxxxxxxx\nspring.mail.properties.mail.smtp.starttls.enable=true\nspring.mail.properties.mail.smtp.port=25 //端口号\nspring.mail.default-encoding=UTF-8\n</code></pre><h2 id=\"添加测试方法\"><a href=\"#添加测试方法\" class=\"headerlink\" title=\"添加测试方法\"></a>添加测试方法</h2><pre><code>@Autowired\nJavaMailSender mailSender;   //自动注入邮件配置\n\n@Value(&quot;${spring.mail.username}&quot;)\nprivate String Sender; //读取配置文件中的参数\n\npublic String sendSimpleMail(){\n    SimpleMailMessage message = new SimpleMailMessage();\n    message.setFrom(Sender);   //邮件发送人\n    //需要多人接收使用list 集合 不需要可以直接使用message的几个方法\n    List&lt;String&gt; list = new ArrayList&lt;String&gt;();\n    list.add(&quot;xxxx@xxx.com&quot;);\n    list.add(&quot;xxx@xxx.com&quot;);\n    for (int i = 0; i &lt; list.size(); i++) {\n        String obj=(String)list.get(i);\n        message.setTo(obj);\n        message.setSubject(&quot;订单&quot;);   //邮件主题\n        message.setText(pd.getString(&quot;message&quot;)+pd.get(&quot;uid&quot;));   //邮件内容\n        mailSender.send(message);\n    }\n    return &quot;OK&quot;;\n}\n</code></pre><h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><pre><code>邮箱开放25/465端口(基本,有些开放其他端口)发送邮件\nmessage.setTo //接收人\nmessage.setCc //抄送人\n...\n阿里ecs默认封25端口 可以使用ssl 传输\n</code></pre><h2 id=\"ssl加密发送邮件\"><a href=\"#ssl加密发送邮件\" class=\"headerlink\" title=\"ssl加密发送邮件\"></a>ssl加密发送邮件</h2><pre><code>修改properties配置\n//spring.mail.properties.mail.smtp.port=25\nspring.mail.properties.mail.smtp.port=465\n添加properties配置:\n#SSL证书Socket工厂\nspring.mail.properties.mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory\n</code></pre><p>使用465 服务器成功发送(<em>^_^</em>)</p>","categories":[],"tags":[]}