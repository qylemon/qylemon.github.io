{"title":"SpringBoot 导出excel","slug":"使用poi导出excel","date":"2020-03-15T01:44:40.480Z","updated":"2020-06-11T06:15:59.556Z","comments":true,"path":"api/articles/使用poi导出excel.json","excerpt":"如题 通过poi实现excel导出","covers":["https://img-blog.csdn.net/20180902201313357?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzMjI5NjY5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70"],"content":"<p>如题 通过poi实现excel导出<a id=\"more\"></a></p>\n<h2 id=\"实现如下\"><a href=\"#实现如下\" class=\"headerlink\" title=\"实现如下\"></a>实现如下</h2><h3 id=\"导入pom包\"><a href=\"#导入pom包\" class=\"headerlink\" title=\"导入pom包\"></a>导入pom包</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;poi&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;4.0.0&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;4.0.0&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">try &#123;</span><br><span class=\"line\">    HSSFWorkbook wb = new HSSFWorkbook();</span><br><span class=\"line\">    // 根据页面index 获取sheet页</span><br><span class=\"line\">    HSSFSheet sheet = wb.createSheet(&quot;sheet名称&quot;);</span><br><span class=\"line\">    HSSFRow c = sheet.createRow(0);</span><br><span class=\"line\">    c.createCell(0).setCellValue(&quot;xxxx&quot;);\t//列0</span><br><span class=\"line\">    for (int i = 0; i &lt; xxx.size(); i++) &#123;</span><br><span class=\"line\">        xxx x = xxx.get(i);</span><br><span class=\"line\">        // 创建HSSFRow对象</span><br><span class=\"line\">        HSSFRow row = sheet.createRow(i + 1);</span><br><span class=\"line\">        // 创建HSSFCell对象 设置单元格的值</span><br><span class=\"line\">        row.createCell(0).setCellValue(x.getxxx());</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 输出Excel文件</span><br><span class=\"line\">    OutputStream output = response.getOutputStream();</span><br><span class=\"line\">    response.reset();</span><br><span class=\"line\">    // 设置文件头</span><br><span class=\"line\">    response.setHeader(&quot;Content-Disposition&quot;,</span><br><span class=\"line\">            &quot;attchement;filename=&quot; + new String(&quot;excel名称.xls&quot;.getBytes(&quot;gb2312&quot;), &quot;ISO8859-1&quot;));</span><br><span class=\"line\">    response.setContentType(&quot;application/msexcel&quot;);</span><br><span class=\"line\">    wb.write(output);</span><br><span class=\"line\">    wb.close();</span><br><span class=\"line\">&#125; catch (Exception e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"注意点\"><a href=\"#注意点\" class=\"headerlink\" title=\"注意点\"></a>注意点</h3><ol>\n<li>一般我们存储时间时都是yyyy-MM-dd 和yyyy-MM-dd HH:mm:ss的格式，但是导入到excel却变成了数字→<code>年月日.时分秒</code>的形式<img src=\"https://img-blog.csdn.net/20180902201313357?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzMjI5NjY5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70\" alt><br>处理方式如下<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 日期格式转为字符串输出</span><br><span class=\"line\">SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span><br><span class=\"line\">String time= sdf.format(column);</span><br><span class=\"line\">dataRow.createCell(x).setCellValue(time);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"end\"><a href=\"#end\" class=\"headerlink\" title=\"end\"></a>end</h2>","more":"</p>\n<h2 id=\"实现如下\"><a href=\"#实现如下\" class=\"headerlink\" title=\"实现如下\"></a>实现如下</h2><h3 id=\"导入pom包\"><a href=\"#导入pom包\" class=\"headerlink\" title=\"导入pom包\"></a>导入pom包</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;poi&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;4.0.0&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;4.0.0&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">try &#123;</span><br><span class=\"line\">    HSSFWorkbook wb = new HSSFWorkbook();</span><br><span class=\"line\">    // 根据页面index 获取sheet页</span><br><span class=\"line\">    HSSFSheet sheet = wb.createSheet(&quot;sheet名称&quot;);</span><br><span class=\"line\">    HSSFRow c = sheet.createRow(0);</span><br><span class=\"line\">    c.createCell(0).setCellValue(&quot;xxxx&quot;);\t//列0</span><br><span class=\"line\">    for (int i = 0; i &lt; xxx.size(); i++) &#123;</span><br><span class=\"line\">        xxx x = xxx.get(i);</span><br><span class=\"line\">        // 创建HSSFRow对象</span><br><span class=\"line\">        HSSFRow row = sheet.createRow(i + 1);</span><br><span class=\"line\">        // 创建HSSFCell对象 设置单元格的值</span><br><span class=\"line\">        row.createCell(0).setCellValue(x.getxxx());</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // 输出Excel文件</span><br><span class=\"line\">    OutputStream output = response.getOutputStream();</span><br><span class=\"line\">    response.reset();</span><br><span class=\"line\">    // 设置文件头</span><br><span class=\"line\">    response.setHeader(&quot;Content-Disposition&quot;,</span><br><span class=\"line\">            &quot;attchement;filename=&quot; + new String(&quot;excel名称.xls&quot;.getBytes(&quot;gb2312&quot;), &quot;ISO8859-1&quot;));</span><br><span class=\"line\">    response.setContentType(&quot;application/msexcel&quot;);</span><br><span class=\"line\">    wb.write(output);</span><br><span class=\"line\">    wb.close();</span><br><span class=\"line\">&#125; catch (Exception e) &#123;</span><br><span class=\"line\">    e.printStackTrace();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"注意点\"><a href=\"#注意点\" class=\"headerlink\" title=\"注意点\"></a>注意点</h3><ol>\n<li>一般我们存储时间时都是yyyy-MM-dd 和yyyy-MM-dd HH:mm:ss的格式，但是导入到excel却变成了数字→<code>年月日.时分秒</code>的形式<img src=\"https://img-blog.csdn.net/20180902201313357?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzMzMjI5NjY5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70\" alt><br>处理方式如下<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 日期格式转为字符串输出</span><br><span class=\"line\">SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);</span><br><span class=\"line\">String time= sdf.format(column);</span><br><span class=\"line\">dataRow.createCell(x).setCellValue(time);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"end\"><a href=\"#end\" class=\"headerlink\" title=\"end\"></a>end</h2>","categories":[{"name":"后端","path":"api/categories/后端.json"}],"tags":[{"name":"SpringBoot","path":"api/tags/SpringBoot.json"},{"name":"POI","path":"api/tags/POI.json"}]}