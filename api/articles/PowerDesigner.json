{"title":"PowerDesigner踩坑过程","slug":"PowerDesigner","date":"2019-03-21T14:24:59.327Z","updated":"2020-02-26T10:00:17.001Z","comments":true,"path":"api/articles/PowerDesigner.json","excerpt":"1.安装及入门pd16.5下载、破解、汉化教程","covers":["https://picabstract-preview-ftn.weiyun.com/ftn_pic_abs_v3/f853be8a78b07ff3dea4b8e88a8378b404e8e763272a3575e830a54aa92bb024e9cb67b7424fb9bb6891fdc5e7ea3e17?pictype=scale&amp;from=30113&amp;version=3.3.3.3&amp;uin=1643994375&amp;fname=20200226175739.png&amp;size=750"],"content":"<h2 id=\"1-安装及入门\"><a href=\"#1-安装及入门\" class=\"headerlink\" title=\"1.安装及入门\"></a>1.安装及入门</h2><p><a href=\"https://blog.csdn.net/sinat_34104446/article/details/79885141\" target=\"_blank\" rel=\"noopener\">pd16.5下载、破解、汉化教程</a><a id=\"more\"></a><br><a href=\"https://www.cnblogs.com/biehongli/p/6025954.html\" target=\"_blank\" rel=\"noopener\">PowerDesigner最基础的使用方法入门学习</a></p>\n<h2 id=\"2-小技巧\"><a href=\"#2-小技巧\" class=\"headerlink\" title=\"2.小技巧\"></a>2.小技巧</h2><h3 id=\"去黑线-强迫症患者\"><a href=\"#去黑线-强迫症患者\" class=\"headerlink\" title=\"去黑线(强迫症患者)\"></a>去黑线(强迫症患者)</h3><pre><code>模型默认在黑色线框中显示，影响视觉体验 &lt;br&gt;\n`Tools→DispalyPreferences 将show page delimiter 取消勾选`\n</code></pre><h3 id=\"sql反向生成模型\"><a href=\"#sql反向生成模型\" class=\"headerlink\" title=\"sql反向生成模型\"></a>sql反向生成模型</h3><pre><code>`File→Reverse Engineer→Database 选择类型选择文件 生成`\n</code></pre><h3 id=\"导出excel表格文件\"><a href=\"#导出excel表格文件\" class=\"headerlink\" title=\"导出excel表格文件\"></a>导出excel表格文件</h3><pre><code>`选中tables ctrl + shift +x 然后运行脚本（脚本如下）`\n</code></pre><h3 id=\"补充\"><a href=\"#补充\" class=\"headerlink\" title=\"补充\"></a>补充</h3><h4 id=\"关于默认值\"><a href=\"#关于默认值\" class=\"headerlink\" title=\"关于默认值\"></a>关于默认值</h4><p>有些列是拥有默认值的比如创建时间和修改时间 再比如主键等，pd的时间设置如下</p>\n<blockquote>\n<p>单击选中column – 右击选择properties Standard Checks页面中的default 如下图</p>\n</blockquote>\n<p><img src=\"https://picabstract-preview-ftn.weiyun.com/ftn_pic_abs_v3/f853be8a78b07ff3dea4b8e88a8378b404e8e763272a3575e830a54aa92bb024e9cb67b7424fb9bb6891fdc5e7ea3e17?pictype=scale&amp;from=30113&amp;version=3.3.3.3&amp;uin=1643994375&amp;fname=20200226175739.png&amp;size=750\" alt></p>\n<p>主键则在properties打开后直接在general页面 勾选identity即可</p>\n<h2 id=\"导出excel\"><a href=\"#导出excel\" class=\"headerlink\" title=\"导出excel\"></a>导出excel</h2><pre><code>&apos;******************************************************************************\n\n&apos;* File:     pdm2excel.txt\n\n&apos;* Title:    pdm export to excel\n\n&apos;* Purpose:  To export the tables and columns to Excel\n\n&apos;* Model:    Physical Data Model 16.5 , Microsoft Office 2007\n\n&apos;* Objects:  Table, Column, View\n\n&apos;******************************************************************************\n\nOption Explicit\n\n   Dim rowsNum\n\n   rowsNum = 0\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Main function\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Get the current active model\n\nDim Model\n\nSet Model = ActiveModel\n\nIf (Model Is Nothing) Or (Not Model.IsKindOf(PdPDM.cls_Model)) Then\n\n  MsgBox &quot;The current model is not an PDM model.&quot;\n\nElse\n\n &apos; Get the tables collection\n\n &apos;创建EXCEL APP\n\n dim beginrow\n\n DIM EXCEL, SHEET\n\n set EXCEL = CREATEOBJECT(&quot;Excel.Application&quot;)\n\n EXCEL.workbooks.add(-4167)&apos;添加工作表\n\n EXCEL.workbooks(1).sheets(1).name =&quot;test&quot;\n\n set sheet = EXCEL.workbooks(1).sheets(&quot;test&quot;)\n\n\n\n ShowProperties Model, SHEET\n\n EXCEL.visible = true\n\n &apos;设置列宽和自动换行\n\n sheet.Columns(1).ColumnWidth = 20 \n\n sheet.Columns(2).ColumnWidth = 40 \n\n sheet.Columns(4).ColumnWidth = 20 \n\n sheet.Columns(5).ColumnWidth = 20 \n\n sheet.Columns(6).ColumnWidth = 15 \n\n sheet.Columns(1).WrapText =true\n\n sheet.Columns(2).WrapText =true\n\n sheet.Columns(4).WrapText =true\n\n End If\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Show properties of tables\n\n&apos;-----------------------------------------------------------------------------\n\nSub ShowProperties(mdl, sheet)\n\n   &apos; Show tables of the current model/package\n\n   rowsNum=0\n\n   beginrow = rowsNum+1\n\n   &apos; For each table\n\n   output &quot;begin&quot;\n\n   Dim tab\n\n   For Each tab In mdl.tables\n\n      ShowTable tab,sheet\n\n   Next\n\n   if mdl.tables.count &gt; 0 then\n\n        sheet.Range(&quot;A&quot; &amp; beginrow + 1 &amp; &quot;:A&quot; &amp; rowsNum).Rows.Group\n\n   end if\n\n   output &quot;end&quot;\n\nEnd Sub\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Show table properties\n\n&apos;-----------------------------------------------------------------------------\n\nSub ShowTable(tab, sheet)\n\n   If IsObject(tab) Then\n\n Dim rangFlag\n\n rowsNum = rowsNum + 1\n\n  &apos; Show properties\n\n  Output &quot;================================&quot;\n\n  sheet.cells(rowsNum, 1) = &quot;实体名&quot;\n\n  sheet.cells(rowsNum, 2) =tab.name\n\n  sheet.cells(rowsNum, 3) = &quot;&quot;\n\n  sheet.cells(rowsNum, 4) = &quot;表名&quot;\n\n  sheet.cells(rowsNum, 5) = tab.code\n\n  sheet.Range(sheet.cells(rowsNum, 5),sheet.cells(rowsNum, 6)).Merge\n\n  rowsNum = rowsNum + 1\n\n  sheet.cells(rowsNum, 1) = &quot;属性名&quot;\n\n  sheet.cells(rowsNum, 2) = &quot;说明&quot;\n\n  sheet.cells(rowsNum, 3) = &quot;&quot;\n\n  sheet.cells(rowsNum, 4) = &quot;字段中文名&quot;\n\n  sheet.cells(rowsNum, 5) = &quot;字段名&quot;\n\n  sheet.cells(rowsNum, 6) = &quot;字段类型&quot;\n\n  &apos;设置边框\n\n  sheet.Range(sheet.cells(rowsNum-1, 1),sheet.cells(rowsNum, 2)).Borders.LineStyle = &quot;1&quot;\n\n  sheet.Range(sheet.cells(rowsNum-1, 4),sheet.cells(rowsNum, 6)).Borders.LineStyle = &quot;1&quot;\n\nDim col &apos; running column\n\nDim colsNum\n\ncolsNum = 0\n\n  for each col in tab.columns\n\n    rowsNum = rowsNum + 1\n\n    colsNum = colsNum + 1\n\n  sheet.cells(rowsNum, 1) = col.name\n\n  sheet.cells(rowsNum, 2) = col.comment\n\n    sheet.cells(rowsNum, 3) = &quot;&quot;\n\n  sheet.cells(rowsNum, 4) = col.name\n\n  sheet.cells(rowsNum, 5) = col.code\n\n  sheet.cells(rowsNum, 6) = col.datatype\n\n  next\n\n  sheet.Range(sheet.cells(rowsNum-colsNum+1,1),sheet.cells(rowsNum,2)).Borders.LineStyle = &quot;2&quot;       \n\n  sheet.Range(sheet.cells(rowsNum-colsNum+1,4),sheet.cells(rowsNum,6)).Borders.LineStyle = &quot;2&quot;\n\n  rowsNum = rowsNum + 1\n\n\n\n  Output &quot;FullDescription: &quot;       + tab.Name\n\n   End If\n\nEnd Sub\n</code></pre>","more":"<br><a href=\"https://www.cnblogs.com/biehongli/p/6025954.html\" target=\"_blank\" rel=\"noopener\">PowerDesigner最基础的使用方法入门学习</a></p>\n<h2 id=\"2-小技巧\"><a href=\"#2-小技巧\" class=\"headerlink\" title=\"2.小技巧\"></a>2.小技巧</h2><h3 id=\"去黑线-强迫症患者\"><a href=\"#去黑线-强迫症患者\" class=\"headerlink\" title=\"去黑线(强迫症患者)\"></a>去黑线(强迫症患者)</h3><pre><code>模型默认在黑色线框中显示，影响视觉体验 &lt;br&gt;\n`Tools→DispalyPreferences 将show page delimiter 取消勾选`\n</code></pre><h3 id=\"sql反向生成模型\"><a href=\"#sql反向生成模型\" class=\"headerlink\" title=\"sql反向生成模型\"></a>sql反向生成模型</h3><pre><code>`File→Reverse Engineer→Database 选择类型选择文件 生成`\n</code></pre><h3 id=\"导出excel表格文件\"><a href=\"#导出excel表格文件\" class=\"headerlink\" title=\"导出excel表格文件\"></a>导出excel表格文件</h3><pre><code>`选中tables ctrl + shift +x 然后运行脚本（脚本如下）`\n</code></pre><h3 id=\"补充\"><a href=\"#补充\" class=\"headerlink\" title=\"补充\"></a>补充</h3><h4 id=\"关于默认值\"><a href=\"#关于默认值\" class=\"headerlink\" title=\"关于默认值\"></a>关于默认值</h4><p>有些列是拥有默认值的比如创建时间和修改时间 再比如主键等，pd的时间设置如下</p>\n<blockquote>\n<p>单击选中column – 右击选择properties Standard Checks页面中的default 如下图</p>\n</blockquote>\n<p><img src=\"https://picabstract-preview-ftn.weiyun.com/ftn_pic_abs_v3/f853be8a78b07ff3dea4b8e88a8378b404e8e763272a3575e830a54aa92bb024e9cb67b7424fb9bb6891fdc5e7ea3e17?pictype=scale&amp;from=30113&amp;version=3.3.3.3&amp;uin=1643994375&amp;fname=20200226175739.png&amp;size=750\" alt></p>\n<p>主键则在properties打开后直接在general页面 勾选identity即可</p>\n<h2 id=\"导出excel\"><a href=\"#导出excel\" class=\"headerlink\" title=\"导出excel\"></a>导出excel</h2><pre><code>&apos;******************************************************************************\n\n&apos;* File:     pdm2excel.txt\n\n&apos;* Title:    pdm export to excel\n\n&apos;* Purpose:  To export the tables and columns to Excel\n\n&apos;* Model:    Physical Data Model 16.5 , Microsoft Office 2007\n\n&apos;* Objects:  Table, Column, View\n\n&apos;******************************************************************************\n\nOption Explicit\n\n   Dim rowsNum\n\n   rowsNum = 0\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Main function\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Get the current active model\n\nDim Model\n\nSet Model = ActiveModel\n\nIf (Model Is Nothing) Or (Not Model.IsKindOf(PdPDM.cls_Model)) Then\n\n  MsgBox &quot;The current model is not an PDM model.&quot;\n\nElse\n\n &apos; Get the tables collection\n\n &apos;创建EXCEL APP\n\n dim beginrow\n\n DIM EXCEL, SHEET\n\n set EXCEL = CREATEOBJECT(&quot;Excel.Application&quot;)\n\n EXCEL.workbooks.add(-4167)&apos;添加工作表\n\n EXCEL.workbooks(1).sheets(1).name =&quot;test&quot;\n\n set sheet = EXCEL.workbooks(1).sheets(&quot;test&quot;)\n\n\n\n ShowProperties Model, SHEET\n\n EXCEL.visible = true\n\n &apos;设置列宽和自动换行\n\n sheet.Columns(1).ColumnWidth = 20 \n\n sheet.Columns(2).ColumnWidth = 40 \n\n sheet.Columns(4).ColumnWidth = 20 \n\n sheet.Columns(5).ColumnWidth = 20 \n\n sheet.Columns(6).ColumnWidth = 15 \n\n sheet.Columns(1).WrapText =true\n\n sheet.Columns(2).WrapText =true\n\n sheet.Columns(4).WrapText =true\n\n End If\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Show properties of tables\n\n&apos;-----------------------------------------------------------------------------\n\nSub ShowProperties(mdl, sheet)\n\n   &apos; Show tables of the current model/package\n\n   rowsNum=0\n\n   beginrow = rowsNum+1\n\n   &apos; For each table\n\n   output &quot;begin&quot;\n\n   Dim tab\n\n   For Each tab In mdl.tables\n\n      ShowTable tab,sheet\n\n   Next\n\n   if mdl.tables.count &gt; 0 then\n\n        sheet.Range(&quot;A&quot; &amp; beginrow + 1 &amp; &quot;:A&quot; &amp; rowsNum).Rows.Group\n\n   end if\n\n   output &quot;end&quot;\n\nEnd Sub\n\n&apos;-----------------------------------------------------------------------------\n\n&apos; Show table properties\n\n&apos;-----------------------------------------------------------------------------\n\nSub ShowTable(tab, sheet)\n\n   If IsObject(tab) Then\n\n Dim rangFlag\n\n rowsNum = rowsNum + 1\n\n  &apos; Show properties\n\n  Output &quot;================================&quot;\n\n  sheet.cells(rowsNum, 1) = &quot;实体名&quot;\n\n  sheet.cells(rowsNum, 2) =tab.name\n\n  sheet.cells(rowsNum, 3) = &quot;&quot;\n\n  sheet.cells(rowsNum, 4) = &quot;表名&quot;\n\n  sheet.cells(rowsNum, 5) = tab.code\n\n  sheet.Range(sheet.cells(rowsNum, 5),sheet.cells(rowsNum, 6)).Merge\n\n  rowsNum = rowsNum + 1\n\n  sheet.cells(rowsNum, 1) = &quot;属性名&quot;\n\n  sheet.cells(rowsNum, 2) = &quot;说明&quot;\n\n  sheet.cells(rowsNum, 3) = &quot;&quot;\n\n  sheet.cells(rowsNum, 4) = &quot;字段中文名&quot;\n\n  sheet.cells(rowsNum, 5) = &quot;字段名&quot;\n\n  sheet.cells(rowsNum, 6) = &quot;字段类型&quot;\n\n  &apos;设置边框\n\n  sheet.Range(sheet.cells(rowsNum-1, 1),sheet.cells(rowsNum, 2)).Borders.LineStyle = &quot;1&quot;\n\n  sheet.Range(sheet.cells(rowsNum-1, 4),sheet.cells(rowsNum, 6)).Borders.LineStyle = &quot;1&quot;\n\nDim col &apos; running column\n\nDim colsNum\n\ncolsNum = 0\n\n  for each col in tab.columns\n\n    rowsNum = rowsNum + 1\n\n    colsNum = colsNum + 1\n\n  sheet.cells(rowsNum, 1) = col.name\n\n  sheet.cells(rowsNum, 2) = col.comment\n\n    sheet.cells(rowsNum, 3) = &quot;&quot;\n\n  sheet.cells(rowsNum, 4) = col.name\n\n  sheet.cells(rowsNum, 5) = col.code\n\n  sheet.cells(rowsNum, 6) = col.datatype\n\n  next\n\n  sheet.Range(sheet.cells(rowsNum-colsNum+1,1),sheet.cells(rowsNum,2)).Borders.LineStyle = &quot;2&quot;       \n\n  sheet.Range(sheet.cells(rowsNum-colsNum+1,4),sheet.cells(rowsNum,6)).Borders.LineStyle = &quot;2&quot;\n\n  rowsNum = rowsNum + 1\n\n\n\n  Output &quot;FullDescription: &quot;       + tab.Name\n\n   End If\n\nEnd Sub\n</code></pre>","categories":[],"tags":[]}